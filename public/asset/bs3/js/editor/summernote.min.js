!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){var r,n,i=this.length>>>0,o=!1;for(1<arguments.length&&(n=t,o=!0),r=0;i>r;++r)this.hasOwnProperty(r)&&(o?n=e(n,this[r],r,this):(n=this[r],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return n});var t,r="function"==typeof define&&define.amd,n=function(t){var r="Comic Sans MS"===t?"Courier New":"Comic Sans MS",n=e("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),i=n.css("fontFamily",r).width(),o=n.css("fontFamily",t+","+r).width();return n.remove(),i!==o},i={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(e.fn.jquery),isSupportAmd:r,hasCodeMirror:r?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:n},o=function(){var t=function(e){return function(t){return e===t}},r=function(e,t){return e===t},n=function(){return!0},i=function(){return!1},o=function(e){return function(){return!e.apply(e,arguments)}},l=function(e){return e},a=0,s=function(e){var t=++a+"";return e?e+t:t},u=function(t){var r=e(document);return{top:t.top+r.scrollTop(),left:t.left+r.scrollLeft(),width:t.right-t.left,height:t.bottom-t.top}},c=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t};return{eq:t,eq2:r,ok:n,fail:i,not:o,self:l,uniqueId:s,rect2bnd:u,invertObject:c}}(),l=function(){var e=function(e){return e[0]},t=function(e){return e[e.length-1]},r=function(e){return e.slice(0,e.length-1)},n=function(e){return e.slice(1)},i=function(e,t){var r=e.indexOf(t);return-1===r?null:e[r+1]},l=function(e,t){var r=e.indexOf(t);return-1===r?null:e[r-1]},a=function(e,t){return t=t||o.self,e.reduce(function(e,r){return e+t(r)},0)},s=function(e){for(var t=[],r=-1,n=e.length;++r<n;)t[r]=e[r];return t},u=function(r,i){if(!r.length)return[];var o=n(r);return o.reduce(function(e,r){var n=t(e);return i(t(n),r)?n[n.length]=r:e[e.length]=[r],e},[[e(r)]])},c=function(e){for(var t=[],r=0,n=e.length;n>r;r++)e[r]&&t.push(e[r]);return t};return{head:e,last:t,initial:r,tail:n,prev:l,next:i,sum:a,from:s,compact:c,clusterBy:u}}(),a=function(){var t=function(t){return t&&e(t).hasClass("note-editable")},r=function(t){return t&&e(t).hasClass("note-control-sizing")},n=function(t){var r;if(t.hasClass("note-air-editor")){var n=l.last(t.attr("id").split("-"));return r=function(t){return function(){return e(t+n)}},{editor:function(){return t},editable:function(){return t},popover:r("#note-popover-"),handle:r("#note-handle-"),dialog:r("#note-dialog-")}}return r=function(e){return function(){return t.find(e)}},{editor:function(){return t},dropzone:r(".note-dropzone"),toolbar:r(".note-toolbar"),editable:r(".note-editable"),codable:r(".note-codable"),statusbar:r(".note-statusbar"),popover:r(".note-popover"),handle:r(".note-handle"),dialog:r(".note-dialog")}},s=function(e){return function(t){return t&&t.nodeName===e}},u=function(e){return e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName)},c=function(e){return e&&/^UL|^OL/.test(e.nodeName)},f=function(e){return e&&/^TD|^TH/.test(e.nodeName)},d=function(e,r){for(;e;){if(r(e))return e;if(t(e))break;e=e.parentNode}return null},h=function(e,t){t=t||o.fail;var r=[];return d(e,function(e){return r.push(e),t(e)}),r},p=function(t,r){for(var n=h(t),i=r;i;i=i.parentNode)if(e.inArray(i,n)>-1)return i;return null},g=function(e,t){var r=[],n=!1,i=!1;return function o(l){if(l){if(l===e&&(n=!0),n&&!i&&r.push(l),l===t)return void(i=!0);for(var a=0,s=l.childNodes.length;s>a;a++)o(l.childNodes[a])}}(p(e,t)),r},m=function(e,t){t=t||o.fail;for(var r=[];e&&(r.push(e),!t(e));)e=e.previousSibling;return r},v=function(e,t){t=t||o.fail;for(var r=[];e&&(r.push(e),!t(e));)e=e.nextSibling;return r},y=function(e,t){var r=[];return t=t||o.ok,function n(i){e!==i&&t(i)&&r.push(i);for(var o=0,l=i.childNodes.length;l>o;o++)n(i.childNodes[o])}(e),r},b=function(e,t){var r=t.nextSibling,n=t.parentNode;return r?n.insertBefore(e,r):n.appendChild(e),e},w=function(t,r){return e.each(r,function(e,r){t.appendChild(r)}),t},x=s("#text"),C=function(e){return x(e)?e.nodeValue.length:e.childNodes.length},k=function(e){return 0===e.offset||e.offset===C(e.node)},L=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},S=function(e){return e&&e.childNodes&&e.childNodes.length},M=function(e){var r=e.node,n=e.offset;if(0===n)return t(r)?null:{node:r.parentNode,offset:L(r)};if(S(r)){var i=r.childNodes[n-1];return{node:i,offset:C(i)}}return{node:r,offset:n-1}},T=function(t,r){var n=l.initial(h(r,o.eq(t)));return e.map(n,L).reverse()},_=function(e,t){for(var r=e,n=0,i=t.length;i>n;n++)r=r.childNodes[t[n]];return r},N=function(e,t){if(0===t)return e;if(t>=C(e))return e.nextSibling;if(x(e))return e.splitText(t);var r=e.childNodes[t];return e=b(e.cloneNode(!1),e),w(e,v(r))},A=function(e,t,r){var n=h(t,o.eq(e));return 1===n.length?N(t,r):n.reduce(function(e,n){var i=n.cloneNode(!1);return b(i,n),e===t&&(e=N(e,r)),w(i,v(e)),i})},H=function(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var r=e.parentNode;if(!t){var n,i,o=[];for(n=0,i=e.childNodes.length;i>n;n++)o.push(e.childNodes[n]);for(n=0,i=o.length;i>n;n++)r.insertBefore(o[n],e)}r.removeChild(e)}},O=function(e){return a.isTextarea(e[0])?e.val():e.html()};return{blank:i.isMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:t,isControlSizing:r,buildLayoutInfo:n,isText:x,isPara:u,isList:c,isTable:s("TABLE"),isCell:f,isAnchor:s("A"),isDiv:s("DIV"),isLi:s("LI"),isSpan:s("SPAN"),isB:s("B"),isU:s("U"),isS:s("S"),isI:s("I"),isImg:s("IMG"),isTextarea:s("TEXTAREA"),length:C,isEdgeBP:k,prevBP:M,ancestor:d,listAncestor:h,listNext:v,listPrev:m,listDescendant:y,commonAncestor:p,listBetween:g,insertAfter:b,position:L,makeOffsetPath:T,fromOffsetPath:_,splitTree:A,remove:H,html:O}}(),s={version:"0.5.2",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,codemirror:{theme:"light-table",mode:"text/html",htmlMode:!0,lineWrapping:!0,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,matchTags:!0,autoCloseTags:!0,addModeClass:!0,indentUnit:4,smartIndent:!0,indentWithTabs:!0,electricChars:!0},lang:"en-US",direction:"ltr",toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,onCreateLink:function(e){return-1!==e.indexOf("@")&&-1===e.indexOf(":")?e="mailto:"+e:-1===e.indexOf("://")&&(e="http://"+e),e},keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"BackColor",foreground:"FontColor",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}},u=function(){var t=function(t){return e.Deferred(function(r){e.extend(new FileReader,{onload:function(e){var t=e.target.result;r.resolve(t)},onerror:function(){r.reject(this)}}).readAsDataURL(t)}).promise()},r=function(t){return e.Deferred(function(r){e("<img>").one("load",function(){r.resolve(e(this))}).one("error abort",function(){r.reject(e(this))}).css({display:"none"}).appendTo(document.body).attr("src",t).attr('class','img-responsive')}).promise()};return{readFileAsDataURL:t,createImage:r}}(),c={isEdit:function(e){return-1!==[8,9,13,32].indexOf(e)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},f=function(){var t=function(t,r){if(i.jqueryVersion<1.9){var n={};return e.each(r,function(e,r){n[r]=t.css(r)}),n}return t.css.call(t,r)};this.stylePara=function(t,r){e.each(t.nodes(a.isPara),function(t,n){e(n).css(r)})},this.current=function(r,n){var i=e(a.isText(r.sc)?r.sc.parentNode:r.sc),o=["font-family","font-size","text-align","list-style-type","line-height"],l=t(i,o)||{};if(l["font-size"]=parseInt(l["font-size"],10),l["font-bold"]=document.queryCommandState("bold")?"bold":"normal",l["font-italic"]=document.queryCommandState("italic")?"italic":"normal",l["font-underline"]=document.queryCommandState("underline")?"underline":"normal",l["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",l["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",l["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",r.isOnList()){var s=["circle","disc","disc-leading-zero","square"],u=e.inArray(l["list-style-type"],s)>-1;l["list-style"]=u?"unordered":"ordered"}else l["list-style"]="none";var c=a.ancestor(r.sc,a.isPara);if(c&&c.style["line-height"])l["line-height"]=c.style.lineHeight;else{var f=parseInt(l["line-height"],10)/parseInt(l["font-size"],10);l["line-height"]=f.toFixed(1)}return l.image=a.isImg(n)&&n,l.anchor=r.isOnAnchor()&&a.ancestor(r.sc,a.isAnchor),l.aAncestor=a.listAncestor(r.sc,a.isEditable),l.range=r,l}},d=function(){var t=!!document.createRange,r=function(e,t){var r,n,i=e.parentElement(),o=document.body.createTextRange(),s=l.from(i.childNodes);for(r=0;r<s.length;r++)if(!a.isText(s[r])){if(o.moveToElementText(s[r]),o.compareEndPoints("StartToStart",e)>=0)break;n=s[r]}if(0!==r&&a.isText(s[r-1])){var u=document.body.createTextRange(),c=null;u.moveToElementText(n||i),u.collapse(!n),c=n?n.nextSibling:i.firstChild;var f=e.duplicate();f.setEndPoint("StartToStart",u);for(var d=f.text.replace(/[\r\n]/g,"").length;d>c.nodeValue.length&&c.nextSibling;)d-=c.nodeValue.length,c=c.nextSibling;{c.nodeValue}t&&c.nextSibling&&a.isText(c.nextSibling)&&d===c.nodeValue.length&&(d-=c.nodeValue.length,c=c.nextSibling),i=c,r=d}return{cont:i,offset:r}},n=function(e){var t=function(e,r){var n,i;if(a.isText(e)){var s=a.listPrev(e,o.not(a.isText)),u=l.last(s).previousSibling;n=u||e.parentNode,r+=l.sum(l.tail(s),a.length),i=!u}else{if(n=e.childNodes[r]||e,a.isText(n))return t(n,r);r=0,i=!1}return{cont:n,collapseToStart:i,offset:r}},r=document.body.createTextRange(),n=t(e.cont,e.offset);return r.moveToElementText(n.cont),r.collapse(n.collapseToStart),r.moveStart("character",n.offset),r},i=function(r,s,u,c){this.sc=r,this.so=s,this.ec=u,this.eo=c;var f=function(){if(t){var e=document.createRange();return e.setStart(r,s),e.setEnd(u,c),e}var i=n({cont:r,offset:s});return i.setEndPoint("EndToEnd",n({cont:u,offset:c})),i};this.getBPs=function(){return{sc:r,so:s,ec:u,eo:c}},this.getStartBP=function(){return{node:r,offset:s}},this.getEndBP=function(){return{node:u,offset:c}},this.select=function(){var e=f();if(t){var r=document.getSelection();r.rangeCount>0&&r.removeAllRanges(),r.addRange(e)}else e.select()},this.nodes=function(t){t=t||o.ok;var n=a.listBetween(r,u),i=l.compact(e.map(n,function(e){return a.ancestor(e,t)}));return e.map(l.clusterBy(i,o.eq2),l.head)},this.commonAncestor=function(){return a.commonAncestor(r,u)},this.expand=function(e){var t=a.ancestor(r,e),n=a.ancestor(u,e);if(!t&&!n)return new i(r,s,u,c);var o=this.getBPs();return t&&(o.sc=t,o.so=0),n&&(o.ec=n,o.eo=a.length(n)),new i(o.sc,o.so,o.ec,o.eo)},this.collapse=function(e){return e?new i(r,s,r,s):new i(u,c,u,c)},this.splitText=function(){var e=r===u,t=this.getBPs();return a.isText(u)&&!a.isEdgeBP(this.getEndBP())&&u.splitText(c),a.isText(r)&&!a.isEdgeBP(this.getStartBP())&&(t.sc=r.splitText(s),t.so=0,e&&(t.ec=t.sc,t.eo=c-s)),new i(t.sc,t.so,t.ec,t.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var t=this.splitText(),r=a.prevBP(t.getStartBP());return e.each(t.nodes(),function(e,t){a.remove(t,!a.isPara(t))}),new i(r.node,r.offset,r.node,r.offset)};var d=function(e){return function(){var t=a.ancestor(r,e);return!!t&&t===a.ancestor(u,e)}};this.isOnEditable=d(a.isEditable),this.isOnList=d(a.isList),this.isOnAnchor=d(a.isAnchor),this.isOnCell=d(a.isCell),this.isCollapsed=function(){return r===u&&s===c},this.insertNode=function(r){var n=f();if(t)n.insertNode(r);else{var i="node-insert-node-target";r.id=i,n.pasteHTML(r.outerHTML),r=e("#"+i)[0]}return r},this.toString=function(){var e=f();return t?e.toString():e.text},this.bookmark=function(e){return{s:{path:a.makeOffsetPath(e,r),offset:s},e:{path:a.makeOffsetPath(e,u),offset:c}}},this.getClientRects=function(){var e=f();return e.getClientRects()}};return{create:function(e,n,o,l){if(arguments.length)2===arguments.length&&(o=e,l=n);else if(t){var a=document.getSelection();if(0===a.rangeCount)return null;var s=a.getRangeAt(0);e=s.startContainer,n=s.startOffset,o=s.endContainer,l=s.endOffset}else{var u=document.selection.createRange(),c=u.duplicate();c.collapse(!1);var f=u;f.collapse(!0);var d=r(f,!0),h=r(c,!1);e=d.cont,n=d.offset,o=h.cont,l=h.offset}return new i(e,n,o,l)},createFromNode:function(e){return this.create(e,0,e,1)},createFromBookmark:function(e,t){var r=a.fromOffsetPath(e,t.s.path),n=t.s.offset,o=a.fromOffsetPath(e,t.e.path),l=t.e.offset;return new i(r,n,o,l)}}}(),h=function(){this.tab=function(e,t){var r=a.ancestor(e.commonAncestor(),a.isCell),n=a.ancestor(r,a.isTable),i=a.listDescendant(n,a.isCell),o=l[t?"prev":"next"](i,r);o&&d.create(o,0).select()},this.createTable=function(t,r){for(var n,i=[],o=0;t>o;o++)i.push("<td>"+a.blank+"</td>");n=i.join("");for(var l,s=[],u=0;r>u;u++)s.push("<tr>"+n+"</tr>");l=s.join("");var c='<table class="table table-bordered">'+l+"</table>";return e(c)[0]}},p=function(){var t=new f,r=new h;this.saveRange=function(e){e.focus(),e.data("range",d.create())},this.restoreRange=function(e){var t=e.data("range");t&&(t.select(),e.focus())},this.currentStyle=function(e){var r=d.create();return r.isOnEditable()&&t.current(r,e)},this.undo=function(e){e.data("NoteHistory").undo(e)},this.redo=function(e){e.data("NoteHistory").redo(e)};for(var n=this.recordUndo=function(e){e.data("NoteHistory").recordUndo(e)},o=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],s=0,c=o.length;c>s;s++)this[o[s]]=function(e){return function(t,r){n(t),document.execCommand(e,!1,r)}}(o[s]);var p=function(t,r,i){n(t);var o=new Array(i+1).join("&nbsp;");r.insertNode(e('<span id="noteTab">'+o+"</span>")[0]);var l=e("#noteTab").removeAttr("id");r=d.create(l[0],1),r.select(),a.remove(l[0])};this.tab=function(e,t){var n=d.create();n.isCollapsed()&&n.isOnCell()?r.tab(n):p(e,n,t.tabsize)},this.untab=function(){var e=d.create();e.isCollapsed()&&e.isOnCell()&&r.tab(e,!0)},this.insertImage=function(e,t){u.createImage(t).then(function(t){n(e),t.css({display:""}),d.create().insertNode(t[0])}).fail(function(){var t=e.data("callbacks");t.onImageUploadError&&t.onImageUploadError()})},this.insertVideo=function(t,r){n(t);var i,o=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,l=r.match(o),a=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/,s=r.match(a),u=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,c=r.match(u),f=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,h=r.match(f),p=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,g=r.match(p),m=/\/\/v\.youku\.com\/v_show\/id_(\w+)\.html/,v=r.match(m);if(l&&11===l[2].length){var y=l[2];i=e("<iframe>").attr("src","//www.youtube.com/embed/"+y).attr("width","640").attr("height","360")}else s&&s[0].length?i=e("<iframe>").attr("src",s[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):c&&c[0].length?i=e("<iframe>").attr("src",c[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):h&&h[3].length?i=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360"):g&&g[2].length?i=e("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+g[2]).attr("width","640").attr("height","360"):v&&v[1].length&&(i=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+v[1]));i&&(i.attr("frameborder",0),d.create().insertNode(i[0]))},this.formatBlock=function(e,t){n(e),t=i.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t)},this.formatPara=function(e){this.formatBlock(e,"P")};for(var s=1;6>=s;s++)this["formatH"+s]=function(e){return function(t){this.formatBlock(t,"H"+e)}}(s);this.fontSize=function(e,t){n(e),document.execCommand("fontSize",!1,3),i.isFF?e.find("font[size=3]").removeAttr("size").css("font-size",t+"px"):e.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",t+"px")},this.lineHeight=function(e,r){n(e),t.stylePara(d.create(),{lineHeight:r})},this.unlink=function(e){var t=d.create();if(t.isOnAnchor()){n(e);var r=a.ancestor(t.sc,a.isAnchor);t=d.createFromNode(r),t.select(),document.execCommand("unlink")}},this.createLink=function(t,r,i){var o=r.url,l=r.text,a=r.newWindow,s=r.range;n(t),i.onCreateLink&&(o=i.onCreateLink(o)),s=s.deleteContents();var u=s.insertNode(e("<A>"+l+"</A>")[0]);e(u).attr({href:o,target:a?"_blank":""}),s=d.createFromNode(u),s.select()},this.getLinkInfo=function(t){t.focus();var r=d.create().expand(a.isAnchor),n=e(l.head(r.nodes(a.isAnchor)));return{range:r,text:r.toString(),isNewWindow:n.length?"_blank"===n.attr("target"):!0,url:n.length?n.attr("href"):""}},this.getVideoInfo=function(e){e.focus();var t=d.create();if(t.isOnAnchor()){var r=a.ancestor(t.sc,a.isAnchor);t=d.createFromNode(r)}return{text:t.toString()}},this.color=function(e,t){var r=JSON.parse(t),i=r.foreColor,o=r.backColor;n(e),i&&document.execCommand("foreColor",!1,i),o&&document.execCommand("backColor",!1,o)},this.insertTable=function(e,t){n(e);var i=t.split("x");d.create().insertNode(r.createTable(i[0],i[1]))},this.floatMe=function(e,t,r){n(e),r.css("float",t)},this.resize=function(e,t,r){n(e),r.css({width:e.width()*t+"px",height:""})},this.resizeTo=function(e,t,r){var n;if(r){var i=e.y/e.x,o=t.data("ratio");n={width:o>i?e.x:e.y/o,height:o>i?e.x*o:e.y}}else n={width:e.x,height:e.y};t.css(n)},this.removeMedia=function(e,t,r){n(e),r.detach()}},g=function(){var e=[],t=[],r=function(e){var t=e[0],r=d.create();return{contents:e.html(),bookmark:r.bookmark(t),scrollTop:e.scrollTop()}},n=function(e,t){e.html(t.contents).scrollTop(t.scrollTop),d.createFromBookmark(e[0],t.bookmark).select()};this.undo=function(i){var o=r(i);e.length&&(n(i,e.pop()),t.push(o))},this.redo=function(i){var o=r(i);t.length&&(n(i,t.pop()),e.push(o))},this.recordUndo=function(n){t=[],e.push(r(n))}},m=function(){this.update=function(t,r){var n=function(t,r){t.find(".dropdown-menu li a").each(function(){var t=e(this).data("value")+""==r+"";this.className=t?"checked":""})},i=function(e,r){var n=t.find(e);n.toggleClass("active",r())},o=t.find(".note-fontname");if(o.length){var a=r["font-family"];a&&(a=l.head(a.split(",")),a=a.replace(/\'/g,""),o.find(".note-current-fontname").text(a),n(o,a))}var s=t.find(".note-fontsize");s.find(".note-current-fontsize").text(r["font-size"]),n(s,parseFloat(r["font-size"]));var u=t.find(".note-height");n(u,parseFloat(r["line-height"])),i('button[data-event="bold"]',function(){return"bold"===r["font-bold"]}),i('button[data-event="italic"]',function(){return"italic"===r["font-italic"]}),i('button[data-event="underline"]',function(){return"underline"===r["font-underline"]}),i('button[data-event="strikethrough"]',function(){return"strikethrough"===r["font-strikethrough"]}),i('button[data-event="superscript"]',function(){return"superscript"===r["font-superscript"]}),i('button[data-event="subscript"]',function(){return"subscript"===r["font-subscript"]}),i('button[data-event="justifyLeft"]',function(){return"left"===r["text-align"]||"start"===r["text-align"]}),i('button[data-event="justifyCenter"]',function(){return"center"===r["text-align"]}),i('button[data-event="justifyRight"]',function(){return"right"===r["text-align"]}),i('button[data-event="justifyFull"]',function(){return"justify"===r["text-align"]}),i('button[data-event="insertUnorderedList"]',function(){return"unordered"===r["list-style"]}),i('button[data-event="insertOrderedList"]',function(){return"ordered"===r["list-style"]})},this.updateRecentColor=function(t,r,n){var i=e(t).closest(".note-color"),o=i.find(".note-recent-color"),l=JSON.parse(o.attr("data-value"));l[r]=n,o.attr("data-value",JSON.stringify(l));var a="backColor"===r?"background-color":"color";o.find("i").css(a,n)}},v=function(){var e=new m;this.update=function(t,r){e.update(t,r)},this.updateRecentColor=function(t,r,n){e.updateRecentColor(t,r,n)},this.activate=function(e){e.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(e){e.find("button").not('button[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(e,t){var r=e.find('button[data-event="fullscreen"]');r.toggleClass("active",t)},this.updateCodeview=function(e,t){var r=e.find('button[data-event="codeview"]');r.toggleClass("active",t)}},y=function(){var t=new m,r=function(t,r){var n=e(t),i=r?n.offset():n.position(),o=n.outerHeight(!0);return{left:i.left,top:i.top+o}},n=function(e,t){e.css({display:"block",left:t.left,top:t.top})},i=20;this.update=function(a,s,u){t.update(a,s);var c=a.find(".note-link-popover");if(s.anchor){var f=c.find("a"),d=e(s.anchor).attr("href");f.attr("href",d).html(d),n(c,r(s.anchor,u))}else c.hide();var h=a.find(".note-image-popover");s.image?n(h,r(s.image,u)):h.hide();var p=a.find(".note-air-popover");if(u&&!s.range.isCollapsed()){var g=o.rect2bnd(l.last(s.range.getClientRects()));n(p,{left:Math.max(g.left+g.width/2-i,0),top:g.top+g.height})}else p.hide()},this.updateRecentColor=function(e,r,n){t.updateRecentColor(e,r,n)},this.hide=function(e){e.children().hide()}},b=function(){this.update=function(t,r,n){var i=t.find(".note-control-selection");if(r.image){var o=e(r.image),l=n?o.offset():o.position(),a={w:o.outerWidth(!0),h:o.outerHeight(!0)};i.css({display:"block",left:l.left,top:l.top,width:a.w,height:a.h}).data("target",r.image);var s=a.w+"x"+a.h;i.find(".note-control-selection-info").text(s)}else i.hide()},this.hide=function(e){e.children().hide()}},w=function(){var t=function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)};this.showImageDialog=function(r,n){return e.Deferred(function(e){var r=n.find(".note-image-dialog"),i=n.find(".note-image-input"),o=n.find(".note-image-url"),l=n.find(".note-image-btn");r.one("shown.bs.modal",function(){i.replaceWith(i.clone().on("change",function(){e.resolve(this.files),r.modal("hide")})),l.click(function(t){t.preventDefault(),e.resolve(o.val()),r.modal("hide")}),o.on("keyup paste",function(e){var r;r="paste"===e.type?e.originalEvent.clipboardData.getData("text"):o.val(),t(l,r)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){i.off("change"),o.off("keyup paste"),l.off("click"),"pending"===e.state()&&e.reject()}).modal("show")})},this.showVideoDialog=function(r,n,i){return e.Deferred(function(e){var r=n.find(".note-video-dialog"),o=r.find(".note-video-url"),l=r.find(".note-video-btn");r.one("shown.bs.modal",function(){o.val(i.text).keyup(function(){t(l,o.val())}).trigger("keyup").trigger("focus"),l.click(function(t){t.preventDefault(),e.resolve(o.val()),r.modal("hide")})}).one("hidden.bs.modal",function(){o.off("keyup"),l.off("click"),"pending"===e.state()&&e.reject()}).modal("show")})},this.showLinkDialog=function(r,n,i){return e.Deferred(function(e){var r=n.find(".note-link-dialog"),o=r.find(".note-link-text"),l=r.find(".note-link-url"),a=r.find(".note-link-btn"),s=r.find("input[type=checkbox]");r.one("shown.bs.modal",function(){o.val(i.text),o.keyup(function(){i.text=o.val()}),i.url||(i.url=i.text,t(a,i.text)),l.keyup(function(){t(a,l.val()),i.text||o.val(l.val())}).val(i.url).trigger("focus").trigger("select"),s.prop("checked",i.newWindow),a.one("click",function(t){t.preventDefault(),e.resolve({range:i.range,url:l.val(),text:o.val(),newWindow:s.is(":checked")}),r.modal("hide")})}).one("hidden.bs.modal",function(){l.off("keyup"),"pending"===e.state()&&e.reject()}).modal("show")}).promise()},this.showHelpDialog=function(t,r){return e.Deferred(function(e){var t=r.find(".note-help-dialog");t.one("hidden.bs.modal",function(){e.resolve()}).modal("show")}).promise()}};i.hasCodeMirror&&(i.isSupportAmd?require(["CodeMirror"],function(e){t=e}):t=window.CodeMirror);var x=function(){var r=e(window),n=e(document),o=e("html, body"),s=new p,f=new v,d=new y,h=new b,m=new w,x=function(t){var r=e(t).closest(".note-editor, .note-air-editor, .note-air-layout");if(!r.length)return null;var n;return n=r.is(".note-editor, .note-air-editor")?r:e("#note-editor-"+l.last(r.attr("id").split("-"))),a.buildLayoutInfo(n)},C=function(t,r){s.restoreRange(t);var n=t.data("callbacks");n.onImageUpload?n.onImageUpload(r,s,t):e.each(r,function(e,r){u.readFileAsDataURL(r).then(function(e){s.insertImage(t,e)}).fail(function(){n.onImageUploadError&&n.onImageUploadError()})})},k={showLinkDialog:function(e){var t=e.editor(),r=e.dialog(),n=e.editable(),i=s.getLinkInfo(n),o=t.data("options");s.saveRange(n),m.showLinkDialog(n,r,i).then(function(t){s.restoreRange(n),s.createLink(n,t,o),d.hide(e.popover())}).fail(function(){s.restoreRange(n)})},showImageDialog:function(e){var t=e.dialog(),r=e.editable();s.saveRange(r),m.showImageDialog(r,t).then(function(e){s.restoreRange(r),"string"==typeof e?s.insertImage(r,e):C(r,e)}).fail(function(){s.restoreRange(r)})},showVideoDialog:function(e){var t=e.dialog(),r=e.editable(),n=s.getVideoInfo(r);s.saveRange(r),m.showVideoDialog(r,t,n).then(function(e){s.restoreRange(r),s.insertVideo(r,e)}).fail(function(){s.restoreRange(r)})},showHelpDialog:function(e){var t=e.dialog(),r=e.editable();s.saveRange(r),m.showHelpDialog(r,t).then(function(){s.restoreRange(r)})},fullscreen:function(e){var t=e.editor(),n=e.toolbar(),i=e.editable(),l=e.codable(),a=t.data("options"),s=function(e){t.css("width",e.w),i.css("height",e.h),l.css("height",e.h),l.data("cmeditor")&&l.data("cmeditor").setsize(null,e.h)};t.toggleClass("fullscreen");var u=t.hasClass("fullscreen");u?(i.data("orgheight",i.css("height")),r.on("resize",function(){s({w:r.width(),h:r.height()-n.outerHeight()})}).trigger("resize"),o.css("overflow","hidden")):(r.off("resize"),s({w:a.width||"",h:i.data("orgheight")}),o.css("overflow","visible")),f.updateFullscreen(n,u)},codeview:function(e){var r,n,o=e.editor(),l=e.toolbar(),s=e.editable(),u=e.codable(),c=e.popover(),h=o.data("options");o.toggleClass("codeview");var p=o.hasClass("codeview");p?(u.val(s.html()),u.height(s.height()),f.deactivate(l),d.hide(c),u.focus(),i.hasCodeMirror&&(r=t.fromTextArea(u[0],h.codemirror),h.codemirror.tern&&(n=new t.TernServer(h.codemirror.tern),r.ternServer=n,r.on("cursorActivity",function(e){n.updateArgHints(e)})),r.setSize(null,s.outerHeight()),r.autoFormatRange&&r.autoFormatRange({line:0,ch:0},{line:r.lineCount(),ch:r.getTextArea().value.length}),u.data("cmEditor",r))):(i.hasCodeMirror&&(r=u.data("cmEditor"),u.val(r.getValue()),r.toTextArea()),s.html(u.val()||a.emptyPara),s.height(h.height?u.height():"auto"),f.activate(l),s.focus()),f.updateCodeview(e.toolbar(),p)}},L=function(e){a.isImg(e.target)&&e.preventDefault()
},S=function(e){setTimeout(function(){var t=x(e.currentTarget||e.target),r=s.currentStyle(e.target);if(r){var n=t.editor().data("options").airMode;n||f.update(t.toolbar(),r),d.update(t.popover(),r,n),h.update(t.handle(),r,n)}},0)},M=function(e){var t=x(e.currentTarget||e.target);d.hide(t.popover()),h.hide(t.handle())},T=function(e){var t=e.originalEvent.clipboardData;if(t&&t.items&&t.items.length){var r=x(e.currentTarget||e.target),n=l.head(t.items),i="file"===n.kind&&-1!==n.type.indexOf("image/");i&&C(r.editable(),[n.getAsFile()])}},_=function(t){if(a.isControlSizing(t.target)){t.preventDefault(),t.stopPropagation();var r=x(t.target),i=r.handle(),o=r.popover(),l=r.editable(),u=r.editor(),c=i.find(".note-control-selection").data("target"),f=e(c),p=f.offset(),g=n.scrollTop(),m=u.data("options").airMode;n.on("mousemove",function(e){s.resizeTo({x:e.clientX-p.left,y:e.clientY-(p.top-g)},f,!e.shiftKey),h.update(i,{image:c},m),d.update(o,{image:c},m)}).one("mouseup",function(){n.off("mousemove")}),f.data("ratio")||f.data("ratio",f.height()/f.width()),s.recordUndo(l)}},N=function(t){var r=e(t.target).closest("[data-event]");r.length&&t.preventDefault()},A=function(t){var r=e(t.target).closest("[data-event]");if(r.length){var n,i=r.attr("data-event"),o=r.attr("data-value"),a=x(t.target);if(-1!==e.inArray(i,["resize","floatMe","removeMedia"])){var u=a.handle().find(".note-control-selection");n=e(u.data("target"))}if(s[i]){var c=a.editable();c.trigger("focus"),s[i](c,o,n)}else k[i]&&k[i].call(this,a);if(-1!==e.inArray(i,["backColor","foreColor"])){var h=a.editor().data("options",h),p=h.airMode?d:f;p.updateRecentColor(l.head(r),i,o)}S(t)}},H=24,O=function(e){e.preventDefault(),e.stopPropagation();var t=x(e.target).editable(),r=t.offset().top-n.scrollTop(),i=x(e.currentTarget||e.target),o=i.editor().data("options");n.on("mousemove",function(e){var n=e.clientY-(r+H);n=o.minHeight>0?Math.max(n,o.minHeight):n,n=o.maxHeight>0?Math.min(n,o.maxHeight):n,t.height(n)}).one("mouseup",function(){n.off("mousemove")})},D=18,I=function(t,r){var n,i=e(t.target.parentNode),o=i.next(),l=i.find(".note-dimension-picker-mousecatcher"),a=i.find(".note-dimension-picker-highlighted"),s=i.find(".note-dimension-picker-unhighlighted");if(void 0===t.offsetX){var u=e(t.target).offset();n={x:t.pageX-u.left,y:t.pageY-u.top}}else n={x:t.offsetX,y:t.offsetY};var c={c:Math.ceil(n.x/D)||1,r:Math.ceil(n.y/D)||1};a.css({width:c.c+"em",height:c.r+"em"}),l.attr("data-value",c.c+"x"+c.r),3<c.c&&c.c<r.insertTableMaxSize.col&&s.css({width:c.c+1+"em"}),3<c.r&&c.r<r.insertTableMaxSize.row&&s.css({height:c.r+1+"em"}),o.html(c.c+" x "+c.r)},W=function(t){var r=e(),i=t.dropzone,o=t.dropzone.find(".note-dropzone-message");n.on("dragenter",function(e){var n=t.editor.hasClass("codeview");n||r.length||(t.editor.addClass("dragover"),i.width(t.editor.width()),i.height(t.editor.height()),o.text("Drag Image Here")),r=r.add(e.target)}).on("dragleave",function(e){r=r.not(e.target),r.length||t.editor.removeClass("dragover")}).on("drop",function(){r=e(),t.editor.removeClass("dragover")}),i.on("dragenter",function(){i.addClass("hover"),o.text("Drop Image")}).on("dragleave",function(){i.removeClass("hover"),o.text("Drag Image Here")}),i.on("drop",function(e){e.preventDefault();var t=e.originalEvent.dataTransfer;if(t&&t.files){var r=x(e.currentTarget||e.target);r.editable().focus(),C(r.editable(),t.files)}}).on("dragover",!1)};this.bindKeyMap=function(e,t){var r=e.editor,n=e.editable;e=x(n),n.on("keydown",function(i){var o=[];i.metaKey&&o.push("CMD"),i.ctrlKey&&!i.altKey&&o.push("CTRL"),i.shiftKey&&o.push("SHIFT");var l=c.nameFromCode[i.keyCode];l&&o.push(l);var a=t[o.join("+")];a?(i.preventDefault(),s[a]?s[a](n,r.data("options")):k[a]&&k[a].call(this,e)):c.isEdit(i.keyCode)&&s.recordUndo(n)})},this.attach=function(e,t){this.bindKeyMap(e,t.keyMap[i.isMac?"mac":"pc"]),e.editable.on("mousedown",L),e.editable.on("keyup mouseup",S),e.editable.on("scroll",M),e.editable.on("paste",T),e.handle.on("mousedown",_),e.popover.on("click",A),e.popover.on("mousedown",N),t.airMode||(t.disableDragAndDrop||W(e),e.toolbar.on("click",A),e.toolbar.on("mousedown",N),t.disableResizeEditor||e.statusbar.on("mousedown",O));var r=t.airMode?e.popover:e.toolbar,n=r.find(".note-dimension-picker-mousecatcher");if(n.css({width:t.insertTableMaxSize.col+"em",height:t.insertTableMaxSize.row+"em"}).on("mousemove",function(e){I(e,t)}),e.editor.data("options",t),t.styleWithSpan&&!i.isMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)},0),e.editable.data("NoteHistory",new g),t.onenter&&e.editable.keypress(function(e){e.keyCode===c.ENTER&&t.onenter(e)}),t.onfocus&&e.editable.focus(t.onfocus),t.onblur&&e.editable.blur(t.onblur),t.onkeyup&&e.editable.keyup(t.onkeyup),t.onkeydown&&e.editable.keydown(t.onkeydown),t.onpaste&&e.editable.on("paste",t.onpaste),t.onToolbarClick&&e.toolbar.click(t.onToolbarClick),t.onChange){var o=function(){t.onChange(e.editable,e.editable.html())};if(i.isMSIE){var l="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";e.editable.on(l,o)}else e.editable.on("input",o)}e.editable.data("callbacks",{onAutoSave:t.onAutoSave,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onFileUpload:t.onFileUpload,onFileUploadError:t.onFileUpload})},this.dettach=function(e,t){e.editable.off(),e.popover.off(),e.handle.off(),e.dialog.off(),t.airMode||(e.dropzone.off(),e.toolbar.off(),e.statusbar.off())}},C=function(){var t=function(e,t){var r=t.event,n=t.value,i=t.title,o=t.className,l=t.dropdown;return'<button type="button" class="btn btn-success btn-sm'+(o?" "+o:"")+(l?" dropdown-toggle":"")+'"'+(l?' data-toggle="dropdown"':"")+(i?' title="'+i+'"':"")+(r?' data-event="'+r+'"':"")+(n?" data-value='"+n+"'":"")+' tabindex="-1">'+e+(l?' <span class="caret"></span>':"")+"</button>"+(l||"")},r=function(e,r){var n='<i class="'+e+'"></i>';return t(n,r)},n=function(e,t){return'<div class="'+e+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content">'+t+"</div></div>"},l=function(e,t,r,n){return'<div class="'+e+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(t?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+t+"</h4></div>":"")+'<form class="note-modal-form"><div class="modal-body"><div class="row-fluid">'+r+"</div></div>"+(n?'<div class="modal-footer">'+n+"</div>":"")+"</form></div></div></div>"},s={picture:function(e){return r("fa fa-picture-o icon-picture",{event:"showImageDialog",title:e.image.image})},link:function(e){return r("fa fa-link icon-link",{event:"showLinkDialog",title:e.link.link})},video:function(e){return r("fa fa-youtube-play icon-play",{event:"showVideoDialog",title:e.video.video})},table:function(e){var t='<ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return r("fa fa-table icon-table",{title:e.table.table,dropdown:t})},style:function(e,t){var n=t.styleTags.reduce(function(t,r){var n=e.style["p"===r?"normal":r];return t+'<li><a data-event="formatBlock" href="#" data-value="'+r+'">'+("p"===r||"pre"===r?n:"<"+r+">"+n+"</"+r+">")+"</a></li>"},"");return r("fa fa-magic icon-magic",{title:e.style.style,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},fontname:function(e,r){var n=r.fontNames.reduce(function(e,t){return i.isFontInstalled(t)?e+'<li><a data-event="fontName" href="#" data-value="'+t+'"><i class="fa fa-check icon-ok"></i> '+t+"</a></li>":e},""),o='<span class="note-current-fontname">'+r.defaultFontName+"</span>";return t(o,{title:e.font.name,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},fontsize:function(e,r){var n=r.fontSizes.reduce(function(e,t){return e+'<li><a data-event="fontSize" href="#" data-value="'+t+'"><i class="fa fa-check icon-ok"></i> '+t+"</a></li>"},""),i='<span class="note-current-fontsize">11</span>';return t(i,{title:e.font.size,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},color:function(e){var r='<i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i>',n=t(r,{className:"note-recent-color",title:e.color.recent,event:"color",value:'{"backColor":"yellow"}'}),i='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+e.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+e.color.transparent+'">'+e.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+e.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+e.color.reset+'">'+e.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>',o=t("",{title:e.color.more,dropdown:i});return n+o},bold:function(e){return r("fa fa-bold icon-bold",{event:"bold",title:e.font.bold})},italic:function(e){return r("fa fa-italic icon-italic",{event:"italic",title:e.font.italic})},underline:function(e){return r("fa fa-underline icon-underline",{event:"underline",title:e.font.underline})},strikethrough:function(e){return r("fa fa-strikethrough icon-strikethrough",{event:"strikethrough",title:e.font.strikethrough})},superscript:function(e){return r("fa fa-superscript icon-superscript",{event:"superscript",title:e.font.superscript})},subscript:function(e){return r("fa fa-subscript icon-subscript",{event:"subscript",title:e.font.subscript})},clear:function(e){return r("fa fa-eraser icon-eraser",{event:"removeFormat",title:e.font.clear})},ul:function(e){return r("fa fa-list-ul icon-list-ul",{event:"insertUnorderedList",title:e.lists.unordered})},ol:function(e){return r("fa fa-list-ol icon-list-ol",{event:"insertOrderedList",title:e.lists.ordered})},paragraph:function(e){var t=r("fa fa-align-left icon-align-left",{title:e.paragraph.left,event:"justifyLeft"}),n=r("fa fa-align-center icon-align-center",{title:e.paragraph.center,event:"justifyCenter"}),i=r("fa fa-align-right icon-align-right",{title:e.paragraph.right,event:"justifyRight"}),o=r("fa fa-align-justify icon-align-justify",{title:e.paragraph.justify,event:"justifyFull"}),l=r("fa fa-outdent icon-indent-left",{title:e.paragraph.outdent,event:"outdent"}),a=r("fa fa-indent icon-indent-right",{title:e.paragraph.indent,event:"indent"}),s='<div class="dropdown-menu"><div class="note-align btn-group">'+t+n+i+o+'</div><div class="note-list btn-group">'+a+l+"</div></div>";return r("fa fa-align-left icon-align-left",{title:e.paragraph.paragraph,dropdown:s})},height:function(e,t){var n=t.lineHeights.reduce(function(e,t){return e+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'"><i class="fa fa-check icon-ok"></i> '+t+"</a></li>"},"");return r("fa fa-text-height icon-text-height",{title:e.font.height,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},help:function(e){return r("fa fa-question icon-question",{event:"showHelpDialog",title:e.options.help})},fullscreen:function(e){return r("fa fa-arrows-alt icon-fullscreen",{event:"fullscreen",title:e.options.fullscreen})},codeview:function(e){return r("fa fa-code icon-code",{event:"codeview",title:e.options.codeview})},undo:function(e){return r("fa fa-undo icon-undo",{event:"undo",title:e.history.undo})},redo:function(e){return r("fa fa-repeat icon-repeat",{event:"redo",title:e.history.redo})},hr:function(e){return r("fa fa-minus icon-hr",{event:"insertHorizontalRule",title:e.hr.insert})}},u=function(e,i){var o=function(){var t=r("fa fa-edit icon-edit",{title:e.link.edit,event:"showLinkDialog"}),i=r("fa fa-unlink icon-unlink",{title:e.link.unlink,event:"unlink"}),o='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+t+i+"</div>";return n("note-link-popover",o)},l=function(){var i=t('<span class="note-fontsize-10">100%</span>',{title:e.image.resizeFull,event:"resize",value:"1"}),o=t('<span class="note-fontsize-10">50%</span>',{title:e.image.resizeHalf,event:"resize",value:"0.5"}),l=t('<span class="note-fontsize-10">25%</span>',{title:e.image.resizeQuarter,event:"resize",value:"0.25"}),a=r("fa fa-align-left icon-align-left",{title:e.image.floatLeft,event:"floatMe",value:"left"}),s=r("fa fa-align-right icon-align-right",{title:e.image.floatRight,event:"floatMe",value:"right"}),u=r("fa fa-align-justify icon-align-justify",{title:e.image.floatNone,event:"floatMe",value:"none"}),c=r("fa fa-trash-o icon-trash",{title:e.image.remove,event:"removeMedia",value:"none"}),f='<div class="btn-group">'+i+o+l+'</div><div class="btn-group">'+a+s+u+'</div><div class="btn-group">'+c+"</div>";return n("note-image-popover",f)},a=function(){for(var t="",r=0,o=i.airPopover.length;o>r;r++){var l=i.airPopover[r];t+='<div class="note-'+l[0]+' btn-group">';for(var a=0,u=l[1].length;u>a;a++)t+=s[l[1][a]](e,i);t+="</div>"}return n("note-air-popover",t)};return'<div class="note-popover">'+o()+l()+(i.airMode?a():"")+"</div>"},c=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},f=function(e,t){return'<table class="note-shortcut"><thead><tr><th></th><th>'+e+"</th></tr></thead><tbody>"+t+"</tbody></table>"},d=function(e){var t="<tr><td>⌘ + B</td><td>"+e.font.bold+"</td></tr><tr><td>⌘ + I</td><td>"+e.font.italic+"</td></tr><tr><td>⌘ + U</td><td>"+e.font.underline+"</td></tr><tr><td>⌘ + ⇧ + S</td><td>"+e.font.strikethrough+"</td></tr><tr><td>⌘ + \\</td><td>"+e.font.clear+"</td></tr>";return f(e.shortcut.textFormatting,t)},h=function(e){var t="<tr><td>⌘ + Z</td><td>"+e.history.undo+"</td></tr><tr><td>⌘ + ⇧ + Z</td><td>"+e.history.redo+"</td></tr><tr><td>⌘ + ]</td><td>"+e.paragraph.indent+"</td></tr><tr><td>⌘ + [</td><td>"+e.paragraph.outdent+"</td></tr><tr><td>⌘ + ENTER</td><td>"+e.hr.insert+"</td></tr>";return f(e.shortcut.action,t)},p=function(e){var t="<tr><td>⌘ + ⇧ + L</td><td>"+e.paragraph.left+"</td></tr><tr><td>⌘ + ⇧ + E</td><td>"+e.paragraph.center+"</td></tr><tr><td>⌘ + ⇧ + R</td><td>"+e.paragraph.right+"</td></tr><tr><td>⌘ + ⇧ + J</td><td>"+e.paragraph.justify+"</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>"+e.lists.ordered+"</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>"+e.lists.unordered+"</td></tr>";return f(e.shortcut.paragraphFormatting,t)},g=function(e){var t="<tr><td>⌘ + NUM0</td><td>"+e.style.normal+"</td></tr><tr><td>⌘ + NUM1</td><td>"+e.style.h1+"</td></tr><tr><td>⌘ + NUM2</td><td>"+e.style.h2+"</td></tr><tr><td>⌘ + NUM3</td><td>"+e.style.h3+"</td></tr><tr><td>⌘ + NUM4</td><td>"+e.style.h4+"</td></tr><tr><td>⌘ + NUM5</td><td>"+e.style.h5+"</td></tr><tr><td>⌘ + NUM6</td><td>"+e.style.h6+"</td></tr>";return f(e.shortcut.documentStyle,t)},m=function(e,t){var r=t.extraKeys,n="";for(var i in r)r.hasOwnProperty(i)&&(n+="<tr><td>"+i+"</td><td>"+r[i]+"</td></tr>");return f(e.shortcut.extraKeys,n)},v=function(e,t){var r='<table class="note-shortcut-layout"><tbody><tr><td>'+h(e,t)+"</td><td>"+d(e,t)+"</td></tr><tr><td>"+g(e,t)+"</td><td>"+p(e,t)+"</td></tr>";return t.extraKeys&&(r+='<tr><td colspan="2">'+m(e,t)+"</td></tr>"),r+="</tbody</table>"},y=function(e){return e.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")},b=function(e,t){var r=function(){var t="<h5>"+e.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+e.image.url+'</h5><input class="note-image-url form-control" type="text" />',r='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+e.image.insert+"</button>";return l("note-image-dialog",e.image.insert,t,r)},n=function(){var r='<div class="form-group"><div class="col-sm-12"><label>'+e.link.textToDisplay+'</label><input class="note-link-text form-control" type="text" /></div></div><div class="form-group"><div class="col-sm-12"><label>'+e.link.url+'</label><input class="note-link-url form-control" type="text" /></div></div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+e.link.openInNewWindow+"</label></div>"),n='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+e.link.insert+"</button>";return l("note-link-dialog",e.link.insert,r,n)},o=function(){var t='<div class="form-group"><div class="col-sm-12"><label>'+e.video.url+'</label>&nbsp;<small class="text-muted">'+e.video.providers+'</small><input class="note-video-url form-control" type="text" /></div></div>',r='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+e.video.insert+"</button>";return l("note-video-dialog",e.video.insert,t,r)},a=function(){var r='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+e.shortcut.close+'</a><div class="title">'+e.shortcut.shortcuts+"</div>"+(i.isMac?v(e,t):y(v(e,t)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.2</a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p>';return l("note-help-dialog","",r,"")};return'<div class="note-dialog">'+r()+n()+o()+a()+"</div>"},w=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'},x=function(e){return i.isMac&&(e=e.replace("CMD","⌘").replace("SHIFT","⇧")),e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")},C=function(t,r,n){var i=o.invertObject(r),l=t.find("button");l.each(function(t,r){var n=e(r),o=i[n.data("event")];o&&n.attr("title",function(e,t){return t+" ("+x(o)+")"})}).tooltip({container:"body",trigger:"hover",placement:n||"top"}).on("click",function(){e(this).tooltip("hide")})},k=function(t,r){var n=r.colors;t.find(".note-color-palette").each(function(){for(var t=e(this),r=t.attr("data-target-event"),i=[],o=0,l=n.length;l>o;o++){for(var a=n[o],s=[],u=0,c=a.length;c>u;u++){var f=a[u];s.push(['<button type="button" class="note-color-btn" style="background-color:',f,';" data-event="',r,'" data-value="',f,'" title="',f,'" data-toggle="button" tabindex="-1"></button>'].join(""))}i.push("<div>"+s.join("")+"</div>")}t.html(i.join(""))})};this.createLayoutByAirMode=function(t,r){var n=r.keyMap[i.isMac?"mac":"pc"],l=e.summernote.lang[r.lang],a=o.uniqueId();t.addClass("note-air-editor note-editable"),t.attr({id:"note-editor-"+a,contentEditable:!0});var s=document.body,f=e(u(l,r));f.addClass("note-air-layout"),f.attr("id","note-popover-"+a),f.appendTo(s),C(f,n),k(f,r);var d=e(c());d.addClass("note-air-layout"),d.attr("id","note-handle-"+a),d.appendTo(s);var h=e(b(l,r));h.addClass("note-air-layout"),h.attr("id","note-dialog-"+a),h.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")}),h.appendTo(s)},this.createLayoutByFrame=function(t,r){var n=e('<div class="note-editor"></div>');r.width&&n.width(r.width),r.height>0&&e('<div class="note-statusbar">'+(r.disableResizeEditor?"":w())+"</div>").prependTo(n);var o=!t.is(":disabled"),l=e('<div class="note-editable" contentEditable="'+o+'"></div>').prependTo(n);r.height&&l.height(r.height),r.direction&&l.attr("dir",r.direction),l.html(a.html(t)||a.emptyPara),e('<textarea class="note-codable"></textarea>').prependTo(n);for(var f=e.summernote.lang[r.lang],d="",h=0,p=r.toolbar.length;p>h;h++){var g=r.toolbar[h];d+='<div class="note-'+g[0]+' btn-group">';for(var m=0,v=g[1].length;v>m;m++)d+=s[g[1][m]](f,r);d+="</div>"}d='<div class="note-toolbar btn-toolbar">'+d+"</div>";var y=e(d).prependTo(n),x=r.keyMap[i.isMac?"mac":"pc"];k(y,r),C(y,x,"bottom");var L=e(u(f,r)).prependTo(n);k(L,r),C(L,x),e(c()).prependTo(n);var S=e(b(f,r)).prependTo(n);S.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")}),e('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(n),n.insertAfter(t),t.hide()},this.noteEditorFromHolder=function(t){return t.hasClass("note-air-editor")?t:t.next().hasClass("note-editor")?t.next():e()},this.createLayout=function(e,t){this.noteEditorFromHolder(e).length||(t.airMode?this.createLayoutByAirMode(e,t):this.createLayoutByFrame(e,t))},this.layoutInfoFromHolder=function(e){var t=this.noteEditorFromHolder(e);if(t.length){var r=a.buildLayoutInfo(t);for(var n in r)r.hasOwnProperty(n)&&(r[n]=r[n].call());return r}},this.removeLayout=function(e,t,r){r.airMode?(e.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),t.popover.remove(),t.handle.remove(),t.dialog.remove()):(e.html(t.editable.html()),t.editor.remove(),e.show())}};e.summernote=e.summernote||{},e.extend(e.summernote,s);var k=new C,L=new x;e.fn.extend({summernote:function(t){if(t=e.extend({},e.summernote.options,t),this.each(function(r,n){var i=e(n);k.createLayout(i,t);var o=k.layoutInfoFromHolder(i);L.attach(o,t),a.isTextarea(i[0])&&i.closest("form").submit(function(){i.html(i.code())})}),this.first().length&&t.focus){var r=k.layoutInfoFromHolder(this.first());r.editable.focus()}return this.length&&t.oninit&&t.oninit(),this},code:function(t){if(void 0===t){var r=this.first();if(!r.length)return;var n=k.layoutInfoFromHolder(r);if(n&&n.editable){var o=n.editor.hasClass("codeview");return o&&i.hasCodeMirror&&n.codable.data("cmEditor").save(),o?n.codable.val():n.editable.html()}return r.html()}return this.each(function(r,n){var i=k.layoutInfoFromHolder(e(n));i&&i.editable&&i.editable.html(t)}),this},destroy:function(){return this.each(function(t,r){var n=e(r),i=k.layoutInfoFromHolder(n);if(i&&i.editable){var o=i.editor.data("options");L.dettach(i,o),k.removeLayout(n,i,o)}}),this}})});